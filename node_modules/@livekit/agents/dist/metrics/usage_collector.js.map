{"version":3,"sources":["../../src/metrics/usage_collector.ts"],"sourcesContent":["// SPDX-FileCopyrightText: 2024 LiveKit, Inc.\n//\n// SPDX-License-Identifier: Apache-2.0\nimport type { AgentMetrics } from './base.js';\nimport { isLLMMetrics, isSTTMetrics, isTTSMetrics } from './utils.js';\n\nexport interface UsageSummary {\n  llmPromptTokens: number;\n  llmCompletionTokens: number;\n  ttsCharactersCount: number;\n  sttAudioDuration: number;\n}\n\nexport class UsageCollector {\n  #summary: UsageSummary;\n\n  constructor() {\n    this.#summary = {\n      llmPromptTokens: 0,\n      llmCompletionTokens: 0,\n      ttsCharactersCount: 0,\n      sttAudioDuration: 0,\n    };\n  }\n\n  collect(metrics: AgentMetrics) {\n    if (isLLMMetrics(metrics)) {\n      this.#summary.llmPromptTokens += metrics.promptTokens;\n      this.#summary.llmCompletionTokens += metrics.completionTokens;\n    } else if (isTTSMetrics(metrics)) {\n      this.#summary.ttsCharactersCount += metrics.charactersCount;\n    } else if (isSTTMetrics(metrics)) {\n      this.#summary.sttAudioDuration += metrics.audioDuration;\n    }\n  }\n\n  get summary(): UsageSummary {\n    return { ...this.#summary };\n  }\n}\n"],"mappings":"AAIA,SAAS,cAAc,cAAc,oBAAoB;AASlD,MAAM,eAAe;AAAA,EAC1B;AAAA,EAEA,cAAc;AACZ,SAAK,WAAW;AAAA,MACd,iBAAiB;AAAA,MACjB,qBAAqB;AAAA,MACrB,oBAAoB;AAAA,MACpB,kBAAkB;AAAA,IACpB;AAAA,EACF;AAAA,EAEA,QAAQ,SAAuB;AAC7B,QAAI,aAAa,OAAO,GAAG;AACzB,WAAK,SAAS,mBAAmB,QAAQ;AACzC,WAAK,SAAS,uBAAuB,QAAQ;AAAA,IAC/C,WAAW,aAAa,OAAO,GAAG;AAChC,WAAK,SAAS,sBAAsB,QAAQ;AAAA,IAC9C,WAAW,aAAa,OAAO,GAAG;AAChC,WAAK,SAAS,oBAAoB,QAAQ;AAAA,IAC5C;AAAA,EACF;AAAA,EAEA,IAAI,UAAwB;AAC1B,WAAO,EAAE,GAAG,KAAK,SAAS;AAAA,EAC5B;AACF;","names":[]}